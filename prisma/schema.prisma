datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id    String @id @default(cuid())
  email String @unique

  emailVerificationToken String?   @default(cuid())
  emailTokenCreatedAt    DateTime  @default(now())
  emailVerifiedAt        DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  password           Password?
  resetPasswordToken ResetPasswordToken?

  organizationUser OrganizationUsers[]
  Organization     Organization?
}

model OrganizationUsers {
  subscriptionView   Boolean
  subscriptionEdit   Boolean
  subscriptionCreate Boolean
  orgUsersView       Boolean
  orgUsersEdit       Boolean
  orgUsersCreate     Boolean

  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  organizationId String       @unique

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId String @unique
}

model Organization {
  id               String  @id @default(cuid())
  name             String?
  paymentAccountId String
  email            String
  personal         Boolean

  organizationUser OrganizationUsers[]

  owner   User?   @relation(fields: [ownerId], references: [id])
  ownerId String? @unique

  subscription Subscription?
}

model Subscription {
  id                String  @unique 
  subscriptionLevel String
  active            String

  organization   Organization @relation(fields: [organizationId], references: [id])
  organizationId String       @unique
}

model Password {
  hash String

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId String @unique
}

model ResetPasswordToken {
  id String @id @default(cuid())

  token     String?
  expiresAt DateTime?
  createdAt DateTime  @default(now())

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId String @unique
}

model FakeEmail {
  id      String @id @default(cuid())
  to      String
  from    String
  subject String

  replyTo String?
  text    String?
  html    String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
