import{a as C,b as g,c as P}from"/build/_shared/chunk-HMOOBWRV.js";import{a as F}from"/build/_shared/chunk-L4YW7AOU.js";import{a as w}from"/build/_shared/chunk-BSL3N5K3.js";import{a as v}from"/build/_shared/chunk-QCIUOCWQ.js";import"/build/_shared/chunk-43WRZGA6.js";import"/build/_shared/chunk-TQRC56TV.js";import"/build/_shared/chunk-BPUBDSZ4.js";import"/build/_shared/chunk-T25WUX7R.js";import"/build/_shared/chunk-MLPEZQPG.js";import{e as E,m as u}from"/build/_shared/chunk-BT47YPGH.js";import{a as R,b as I}from"/build/_shared/chunk-5HKR6QTR.js";import{d as n}from"/build/_shared/chunk-G5WX4PPA.js";var e=n(C());var m=n(F());var a=n(R());var r=n(I());function K(){let t=u(),[i,p]=(0,a.useState)(!1),[d,h]=(0,a.useState)(!1),[l,f]=(0,a.useState)(""),c=(0,e.useElements)(),b=(0,e.useStripe)();if("error"in t)return null;let{paymentAccountId:y,clientSecret:_,paymentIntentId:B,subscriptionId:A}=t;return(0,r.jsxs)("div",{className:"mx-auto w-6/12 flex-row justify-center ",children:[d&&(0,r.jsx)("h1",{className:"pb-4 text-center",children:"Subscribe"}),l&&(0,r.jsx)("div",{children:l}),(0,r.jsxs)(E,{onSubmit:async x=>{if(x.preventDefault(),p(!0),f(""),c&&b&&y)try{if(await P(y))throw new Error("User already has an active subscription");let{error:s}=await c.submit();if(s)throw new Error(s.message);let{error:S}=await b.confirmPayment({elements:c,clientSecret:_,confirmParams:{return_url:`${window.location.origin}/pay/success?subscription_id=${A}&payment_intent=${B}`}});if(S)throw new Error(S.message)}catch(o){console.error(o);let s=typeof o=="string"?o:typeof o.message=="string"?o.message:"An error occured processing the Subscription payment";f(s)}finally{p(!1)}},children:[(0,r.jsx)(e.PaymentElement,{onReady:()=>h(!0),options:{layout:"accordion"},className:"py-3"}),d&&(0,r.jsx)(v,{type:"submit",name:"submit-payment",disabled:i,children:i?(0,r.jsx)(w,{}):"Subscribe"})]})]})}function L(){let t=u();if("error"in t)return(0,r.jsx)("div",{children:t.error});let i=g(t.STRIPE_PUBLIC_KEY);return(0,r.jsx)(e.Elements,{stripe:i,options:{clientSecret:t.clientSecret},children:(0,r.jsx)(K,{})})}export{L as default};
