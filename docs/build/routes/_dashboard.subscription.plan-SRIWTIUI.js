import{a as G}from"/build/_shared/chunk-VKA3GPPN.js";import{a as H}from"/build/_shared/chunk-BSL3N5K3.js";import{a as ae}from"/build/_shared/chunk-WB4UELY7.js";import{a as $,b as F}from"/build/_shared/chunk-TILAEZZA.js";import{a as b}from"/build/_shared/chunk-QCIUOCWQ.js";import{b as U,c as q,g as S,h as Y,o as j,p as g}from"/build/_shared/chunk-FPCZUKCW.js";import{u as d}from"/build/_shared/chunk-EZ5BYJGA.js";import"/build/_shared/chunk-43WRZGA6.js";import{a as D}from"/build/_shared/chunk-TQRC56TV.js";import"/build/_shared/chunk-BPUBDSZ4.js";import"/build/_shared/chunk-6CKUMXI6.js";import"/build/_shared/chunk-T25WUX7R.js";import{a as m}from"/build/_shared/chunk-AJKPLCOI.js";import"/build/_shared/chunk-5T3E4OPG.js";import"/build/_shared/chunk-MLPEZQPG.js";import{b as k,e as N,l as R,m as E}from"/build/_shared/chunk-BT47YPGH.js";import{a as _,b as y}from"/build/_shared/chunk-5HKR6QTR.js";import{b as P,d as l}from"/build/_shared/chunk-G5WX4PPA.js";var K=P(I=>{"use strict";var re=$();Object.defineProperty(I,"__esModule",{value:!0});I.default=void 0;var ie=re(F()),ne=y(),le=(0,ie.default)((0,ne.jsx)("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"KeyboardArrowLeft");I.default=le});var Z=P(A=>{"use strict";var me=$();Object.defineProperty(A,"__esModule",{value:!0});A.default=void 0;var ue=me(F()),pe=y(),ce=(0,ue.default)((0,pe.jsx)("path",{d:"M11 15h2v2h-2v-2zm0-8h2v6h-2V7zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutlineOutlined");A.default=ce});var z=l(K());var p=l(_());var W=l(G()),s=l(_());var V=async(o,u)=>await(await fetch(`/api/subscription/${o}/preview?priceId=${u}`)).json();var i=l(y());var J=(n=>(n.Update="put",n.Cancel="delete",n.Subscribe="post",n))(J||{}),de=({subId:o,planId:u,handleInvoicePreviewTimeStamp:e})=>{let[n,B]=(0,s.useState)(),[c,v]=(0,s.useState)(),[t,f]=(0,s.useState)();return(0,s.useEffect)(()=>{let r=async()=>await V(o,u);u&&o&&(f(!0),r().then(({data:x,error:C})=>{C?(console.error(C),v("Something went wrong previewing this invoice")):x&&(B(x),e(x.prorationDate))}).finally(()=>{f(!1)}))},[u,o,e]),(0,i.jsxs)(m,{children:[t&&(0,i.jsx)(H,{}),c&&(0,i.jsx)(m,{children:c}),!t&&!c&&(n==null?void 0:n.periodEnd)&&(0,i.jsx)(m,{display:"flex",flexDirection:"column",justifyContent:"space-between",paddingY:1,children:(0,i.jsxs)(d,{children:["By changing to this plan, you will be billed $",n.upcomingToBeBilled/100," for the upcoming billing cycle beginning on"," ",(0,W.default)(new Date(n.periodEnd*1e3)).add(1,"day").format("MMMM DD, YYYY"),". This amount reflects proration for any remaining days left in the current billing cycle."]})})]})};function L({subscriptionPlanOption:o,open:u,currentSubscription:e,secondaryAction:n,onClose:B}){let[c,v]=(0,s.useState)(),t=(0,s.useMemo)(()=>(e==null?void 0:e.activeStatus)==="active",[e]),f=(0,s.useMemo)(()=>t?(o==null?void 0:o.product.name)===(e==null?void 0:e.subscriptionLevel)?"Cancel Plan":"Change Plan":"Choose Plan",[t,o,e]),r=(0,s.useMemo)(()=>t?(e==null?void 0:e.subscriptionLevel)===(o==null?void 0:o.product.name)?"Cancel":"Update":"Subscribe",[t,e==null?void 0:e.subscriptionLevel,o]),x=(0,s.useCallback)(C=>{v(C)},[]);return o?(0,i.jsx)(Y,{onClose:B,open:u,"data-testid":"subscription-plan-modal",children:(0,i.jsx)(m,{minHeight:200,minWidth:400,boxShadow:2,borderRadius:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",padding:2,children:(0,i.jsxs)(N,{method:J[r],action:"/subscription/manage",children:[(0,i.jsx)(d,{variant:"subtitle2",children:f}),(0,i.jsxs)(d,{variant:"subtitle2",paddingY:2,children:[o.product.name," - $",((o==null?void 0:o.unit_amount)||0)/100," per month"]}),r==="Update"&&e&&(0,i.jsx)(de,{subId:e==null?void 0:e.id,planId:o.id,handleInvoicePreviewTimeStamp:x}),(0,i.jsx)(m,{paddingTop:2,paddingBottom:6,children:(0,i.jsx)(d,{children:"Cancel anytime in subscription. Plan automatically renews until canceled."})}),(0,i.jsxs)(m,{position:"absolute",bottom:"8",right:"8",children:[(0,i.jsx)(D,{onClick:n,children:"Dismiss"}),(0,i.jsx)("input",{type:"hidden",name:"planId",value:o.id}),(0,i.jsx)("input",{type:"hidden",name:"subId",value:e==null?void 0:e.id}),(0,i.jsx)("input",{type:"hidden",name:"invoiceTimeStamp",value:c}),(0,i.jsx)(D,{type:"submit",variant:"contained",children:r})]})]})})}):null}var O=l(G());var Q=l(ae()),h=l(y()),se=({description:o,number:u})=>(0,h.jsxs)(g,{direction:"row",alignContent:"center",paddingBottom:3,children:[(0,h.jsx)(m,{alignItems:"center",display:"flex",paddingRight:3,color:"action.active",children:(0,h.jsx)(Q.default,{color:"inherit"})}),(0,h.jsxs)(g,{children:[(0,h.jsxs)(d,{paddingBottom:1,variant:"h5",color:"text.secondary",children:["Feature ",u]}),(0,h.jsx)(d,{variant:"body2",color:"text.secondary",children:o})]})]}),X=se;var ee=l(Z()),a=l(y()),ve=["Suscipit lacus elit lobortis ultrices a diam. Diam eu est vel mollis ut. At mi id morbi blandit pharetra in neque. Enim adipiscing dui sed urna at vivamus. Nisl nisl id vitae non sed. Risus ut viverra nulla urna posuere varius.","Suscipit lacus elit lobortis ultrices a diam. Diam eu est vel mollis ut. At mi id morbi blandit pharetra in neque. Enim adipiscing dui sed urna at vivamus. Nisl nisl id vitae non sed. Risus ut viverra nulla urna posuere varius.","Suscipit lacus elit lobortis ultrices a diam. Diam eu est vel mollis ut. At mi id morbi blandit pharetra in neque. Enim adipiscing dui sed urna at vivamus. Nisl nisl id vitae non sed. Risus ut viverra nulla urna posuere varius."];function te(){var M;let{error:o}=E(),[u,e]=(0,p.useState)(!1),[n,B]=(0,p.useState)(!!o),{priceId:c}=E(),{optionResults:v,organizationSubscription:t}=(M=R().find(T=>T.pathname==="/subscription"))==null?void 0:M.data,f=k(),r=(0,p.useMemo)(()=>{var T;return(T=v==null?void 0:v.subscriptionOptions)==null?void 0:T.find(w=>w.id===c)},[v,c]),x=(0,p.useCallback)(()=>{f(-1)},[f]),C=(0,p.useCallback)(()=>{e(!1)},[]),oe=(0,p.useMemo)(()=>t?(r==null?void 0:r.product.name)===(t==null?void 0:t.subscriptionLevel)?t!=null&&t.cancellationDate?`Canceling on ${(0,O.default)(new Date((t==null?void 0:t.cancellationDate)*1e3)).format("MMMM DD, YYYY")}`:"cancel plan":"update plan":"subscribe to plan",[t,r]);return r||f(-1),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L,{subscriptionPlanOption:r,secondaryAction:C,open:u,currentSubscription:t,onClose:C}),(0,a.jsxs)(S,{children:[(0,a.jsxs)(g,{alignItems:"center",marginTop:"44px",paddingBottom:2,children:[(0,a.jsx)(j,{animation:!1,variant:"rectangular",width:"100px",height:"100px",sx:{display:"flex"},component:m,justifyContent:"center",alignItems:"center",borderRadius:"32px",children:(0,a.jsx)(d,{component:"span",visibility:"visible",children:"Graphic"})}),(0,a.jsxs)(g,{alignItems:"center",children:[(0,a.jsxs)(d,{variant:"h4",color:"text.primary",children:["Get ",r==null?void 0:r.product.name," for"]}),(0,a.jsxs)(d,{variant:"h3",color:"text.primary",children:["$",((r==null?void 0:r.unit_amount)||0)/100]}),(0,a.jsx)(d,{variant:"body2",color:"text.primary",children:"Per month"})]})]}),(0,a.jsx)(g,{overflow:"scroll",maxHeight:"450px",children:ve.map((T,w)=>(0,a.jsx)(X,{description:T,number:w+1},`${T.slice(0,4)}-${w}`))}),(0,a.jsxs)(g,{paddingTop:3,children:[(0,a.jsx)(b,{onClick:()=>e(!0),disabled:(r==null?void 0:r.product.name)===(t==null?void 0:t.subscriptionLevel)&&!!(t!=null&&t.cancellationDate)||!1,variant:"buttonLarge",sx:{color:"primary.contrast"},children:oe}),(0,a.jsxs)(b,{variant:"buttonMedium",onClick:x,sx:{"&:hover":{backgroundColor:"#FFF"},color:"primary.main"},children:[(0,a.jsx)(z.default,{}),"Go back"]})]}),n&&(0,a.jsxs)(U,{severity:"error",sx:{position:"absolute",right:34,bottom:34,bgColor:"error.main"},onClose:()=>B(!1),icon:(0,a.jsx)(m,{color:"primary.contrast",children:(0,a.jsx)(ee.default,{color:"inherit"})}),children:[(0,a.jsx)(q,{children:"A problem occurred setting up the subscription"}),"Please contact customer support to resolve this issue."]})]})]})}export{te as default};
